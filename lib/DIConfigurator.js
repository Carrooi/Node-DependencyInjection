// Generated by CoffeeScript 1.6.3
(function() {
  var Configuration, DI, DIConfigurator;

  DI = require('./DI');

  Configuration = require('easy-configuration');

  DIConfigurator = (function() {
    DIConfigurator.prototype.path = null;

    DIConfigurator.prototype.defaultService = {
      service: null,
      "arguments": [],
      setup: {}
    };

    function DIConfigurator(path) {
      this.path = path;
    }

    DIConfigurator.prototype.create = function() {
      var config, data, defaults, di, method, name, s, service, services, _ref;
      config = new Configuration(this.path);
      defaults = this.defaultService;
      services = config.addSection('services');
      services.loadConfiguration = function() {
        var name;
        config = this.getConfig();
        for (name in config) {
          config[name] = this.configurator.merge(config[name], defaults);
        }
        return config;
      };
      data = config.load().services;
      di = new DI;
      for (name in data) {
        service = data[name];
        s = di.addService(name, service.service, service["arguments"]);
        _ref = service.setup;
        for (method in _ref) {
          arguments = _ref[method];
          s.addSetup(method, arguments);
        }
      }
      return di;
    };

    return DIConfigurator;

  })();

  module.exports = DIConfigurator;

}).call(this);
